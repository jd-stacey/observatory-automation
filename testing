def start_imaging_loop(self, max_exposures: Optional[int] = None,
                       duration_hours: Optional[float] = None,
                       telescope_driver = None) -> bool:
    
    # Call parent initialization
    logger.info("="*75)
    logger.info(" "*25+"STARTING IMAGING SESSION")
    logger.info("="*75)
    
    if self.acquisition_enabled and self.current_phase == SessionPhase.ACQUISITION:
        logger.info("Starting with target acquisition phase")
        acq_exp_time = self.acquisition_config.get('exposure_time', 3.0)
        max_acq_attempts = self.acquisition_config.get('max_attempts', 20)
        logger.info(f"Acquisition: {acq_exp_time}s exposures, max {max_acq_attempts} attempts")
    
    if max_exposures:
        logger.info(f"Maximum exposures: {max_exposures}")
    if duration_hours:
        logger.info(f"Maximum duration: {duration_hours:.1f} hours")
        
    self.session_start_time = time.time()
    self.exposure_count = 0
    self.consecutive_failures = 0
    
    # Field rotation setup (same as parent)
    try:
        if self.rotator_driver:
            fr_cfg = self.config_loader.get_config('field_rotation')
            if fr_cfg.get('enabled', True):
                obs_cfg = self.config_loader.get_config('observatory')
                if self.rotator_driver.initialize_field_rotation(obs_cfg, fr_cfg):
                    self.rotator_driver.set_tracking_target(
                        self.target_info.ra_j2000_hours,
                        self.target_info.dec_j2000_deg,
                        reference_pa_deg=None
                    )
                    self.rotator_driver.start_field_tracking()
                    logger.info("Field-rotation tracking: started (continuous for session)")
    except Exception as e:
        logger.warning(f"Field-rotation start failed: {e}")
    
    try:
        while True:
            # **ADD THIS STOP CHECK**
            if self._stop_event.is_set():
                logger.info("Stop event detected, ending imaging loop")
                break
            
            try:
                image_filepath = self.capture_single_exposure(telescope_driver=telescope_driver)
                if image_filepath:
                    self.exposure_count += 1
                    self.consecutive_failures = 0
                    
                    # Update phase-specific counters
                    if self.current_phase == SessionPhase.ACQUISITION:
                        self.acquisition_count += 1
                    else:
                        self.science_count += 1
                    
                    elapsed_time = (time.time() - self.session_start_time) / 3600
                    phase_info = f"[{self.current_phase.value.upper()}]"
                    logger.info(f"{phase_info} Exposure {self.exposure_count}: {Path(image_filepath).name} "
                               f"(Session: {elapsed_time:.1f} h)")
                else:
                    self.consecutive_failures += 1
                    logger.warning(f"Capture failed ({self.consecutive_failures}/{self.max_consecutive_failures})")
                    
            except Exception as e:
                self.consecutive_failures += 1
                logger.error(f"Exposure error: {e} ({self.consecutive_failures}/{self.max_consecutive_failures})")
                
                if self.consecutive_failures > self.max_consecutive_failures:
                    logger.error("Too many consecutive failures, terminating session")
                    return False
            
            # **ADD STOP CHECK AFTER EACH EXPOSURE TOO**
            if self._stop_event.is_set():
                logger.info("Stop event detected after exposure, ending imaging loop")
                break
            
            # Check if acquisition phase should end
            if (self.current_phase == SessionPhase.ACQUISITION and 
                self.acquisition_count > 0 and
                self._check_acquisition_complete()):
                self._switch_to_science_phase()
            
            # Check general termination conditions
            should_terminate, reason = self.check_termination_conditions(max_exposures, duration_hours)
            if should_terminate:
                logger.info(f"Session terminating: {reason}")
                break
            
            # Apply corrections based on current phase
            if self._should_apply_correction():
                self._apply_periodic_correction()
        
        # Rest of the method is the same as parent...
        session_duration = (time.time() - self.session_start_time) / 3600
        logger.info("="*75)
        logger.info(" "*30+"IMAGING COMPLETED")
        logger.info("="*75)
        logger.info(f"Total exposures: {self.exposure_count}")
        if self.acquisition_enabled:
            logger.info(f"  Acquisition: {self.acquisition_count}")
            logger.info(f"  Science: {self.science_count}")
        logger.info(f"Final phase: {self.current_phase.value}")
        logger.info(f"Files saved to: {self.current_target_dir}")
        logger.info(f"Session duration: {session_duration:.1f} hours")
        return True
        
    except KeyboardInterrupt:
        logger.info("Session interrupted by user")
        return True
    except Exception as e:
        logger.error(f"Session failed: {e}")
        return False
    finally:
        # Stop continuous tracking when session ends
        try:
            if self.rotator_driver:
                self.rotator_driver.stop_field_tracking()
                logger.info("Field-rotation tracking: stopped")
        except Exception:
            pass
