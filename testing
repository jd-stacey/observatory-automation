def _start_autoslew_with_elevation(self):
    """Try multiple methods to start Autoslew with proper elevation"""
    
    if not os.path.exists(self.autoslew_path):
        raise FileNotFoundError(f"Autoslew not found at: {self.autoslew_path}")
    
    # Method 1: Try with shell=True and 'runas' verb
    try:
        self.logger.info("   Attempt 1: Starting with UAC elevation...")
        
        import ctypes
        # Check if we're already running as admin
        is_admin = ctypes.windll.shell32.IsUserAnAdmin()
        if is_admin:
            self.logger.info("   Already running as administrator")
        else:
            self.logger.info("   Requesting administrator privileges...")
        
        # Use ShellExecute with 'runas' to trigger UAC
        result = ctypes.windll.shell32.ShellExecuteW(
            None,
            "runas",  # This triggers UAC
            self.autoslew_path,
            None,
            self.autoslew_dir,
            1  # SW_SHOWNORMAL
        )
        
        if result > 32:  # Success
            self.logger.info("   UAC elevation successful, Autoslew starting...")
            return True
        else:
            self.logger.warning(f"   UAC elevation failed (code: {result})")
            
    except Exception as e:
        self.logger.warning(f"   UAC method failed: {e}")
    
    # Method 2: Try subprocess with shell=True 
    try:
        self.logger.info("   Attempt 2: Shell execution...")
        proc = subprocess.Popen(
            f'"{self.autoslew_path}"',
            cwd=self.autoslew_dir,
            shell=True,
            creationflags=subprocess.CREATE_NEW_PROCESS_GROUP
        )
        
        # Brief wait to see if it fails immediately
        time.sleep(3)
        if proc.poll() is None:
            self.logger.info("   Shell execution appears successful")
            return True
        else:
            self.logger.warning("   Shell execution failed - process exited")
            
    except Exception as e:
        self.logger.warning(f"   Shell method failed: {e}")
    
    # Method 3: PowerShell with Start-Process -Verb RunAs
    try:
        self.logger.info("   Attempt 3: PowerShell elevation...")
        ps_command = f'Start-Process -FilePath "{self.autoslew_path}" -WorkingDirectory "{self.autoslew_dir}" -Verb RunAs'
        
        proc = subprocess.Popen([
            'powershell.exe', 
            '-Command', 
            ps_command
        ], shell=True)
        
        time.sleep(3)
        self.logger.info("   PowerShell elevation command executed")
        return True
        
    except Exception as e:
        self.logger.warning(f"   PowerShell method failed: {e}")
    
    return False

def _autoslew_and_check_worker(self):
    """Worker thread for Autoslew startup with better error handling"""
    try:
        self.logger.info("üöÄ Starting Autoslew launch sequence...")
        
        # Check if already running first
        if self.is_autoslew_running():
            self.logger.info("‚úì Autoslew is already running")
            self.update_status("Autoslew", "Running", "green")
            self.autoslew_started = True
            
            # Wait for services to be ready
            self.logger.info("‚è≥ Waiting for ALPACA services...")
            time.sleep(10)
        else:
            self.logger.info("üîß Starting Autoslew...")
            self.update_status("Autoslew", "Starting...", "orange")
            
            # Try the enhanced startup method
            startup_success = self._start_autoslew_with_elevation()
            
            if not startup_success:
                self.logger.error("‚ùå All Autoslew startup methods failed")
                self.logger.info("üí° Manual solutions:")
                self.logger.info("   1. Right-click on this Python script ‚Üí Run as Administrator")
                self.logger.info("   2. Start Autoslew manually as Administrator")
                self.logger.info("   3. Use 'Manual Check' button after starting Autoslew")
                self.root.after(0, lambda: self.manual_btn.pack(fill='x', pady=2))
                return
            
            self.logger.info("‚ö†Ô∏è Allow Autoslew through any security prompts!")
            
            # Wait for process to start
            max_wait = 60
            for i in range(max_wait):
                if i % 10 == 0 and i > 0:
                    self.logger.info(f"‚è≥ Waiting for Autoslew... {i}/{max_wait} seconds")
                if self.is_autoslew_running():
                    self.logger.info("‚úì Autoslew process started")
                    self.autoslew_started = True
                    break
                time.sleep(1)
            else:
                self.logger.error("‚ùå Autoslew process not detected within 60 seconds")
                self.logger.info("üí° If you saw UAC prompt and clicked 'Yes', Autoslew might still be starting")
                self.logger.info("   Wait a moment, then try 'Manual Check'")
                self.root.after(0, lambda: self.manual_btn.pack(fill='x', pady=2))
                return
                
            self.update_status("Autoslew", "Running", "green")
        
        # Wait for full initialization
        self.logger.info("‚è≥ Waiting for Autoslew full initialization...")
        max_service_wait = 180  # 3 minutes for problem cases
        service_ready = False
        
        for attempt in range(0, max_service_wait, 15):
            if attempt > 0:
                self.logger.info(f"üîç Testing ALPACA services... ({attempt}/{max_service_wait}s)")
            
            telescope_ready = self._check_alpaca_service_ready("127.0.0.1:11111", "telescope", 0)
            rotator_ready = self._check_alpaca_service_ready("127.0.0.1:11112", "rotator", 0)  
            cover_ready = self._check_alpaca_service_ready("127.0.0.1:11112", "covercalibrator", 0)
            
            if telescope_ready or rotator_ready or cover_ready:
                self.logger.info("‚úì At least one ALPACA service responding")
                service_ready = True
                break
                
            if attempt < max_service_wait - 15:
                time.sleep(15)
        
        if not service_ready:
            self.logger.warning("‚ö†Ô∏è ALPACA services not responding")
            self.logger.info("üí° Try 'Manual Check' if Autoslew appears to be running")
            self.root.after(0, lambda: self.manual_btn.pack(fill='x', pady=2))
        
        # Check device connections
        self.logger.info("üîç Checking device status...")
        self._check_all_connections_http_only()
        
    except Exception as e:
        self.logger.error(f"‚ùå Autoslew startup failed: {e}")
        self.logger.info("üí° Try using 'Manual Check' button if Autoslew is running")
        self.root.after(0, lambda: self.manual_btn.pack(fill='x', pady=2))
    finally:
        self.root.after(0, self._finish_autoslew_check)
