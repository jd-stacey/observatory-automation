# Extract target ID from filename (everything before the timestamp)
import re
target_match = re.match(r'^(.+?)_\d{8}_', solved_filename)
current_target_id = target_match.group(1) if target_match else None

# Only check sequence if same target
solved_seq = extract_sequence_from_filename(solved_filename)
if current_target_id and current_target_id == self.last_target_id:
    if solved_seq <= self.last_applied_sequence:
        return CorrectionResult(
            applied=False, ...
            reason=f"Already applied correction for sequence {self.last_applied_sequence}"
        )
else:
    # Different target - reset sequence tracking
    logger.debug(f"New target detected in platesolve: {current_target_id}")
    self.last_target_id = current_target_id
    self.last_applied_sequence = -1
